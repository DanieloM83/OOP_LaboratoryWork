(function(){"use strict";self.onmessage=async c=>{try{const t=c.data;if(!(t instanceof Blob)){self.postMessage({error:"Invalid file input"});return}const e=await createImageBitmap(t),a=512,s=Math.min(a/e.width,a/e.height),o=Math.max(1,Math.floor(e.width*s)),n=Math.max(1,Math.floor(e.height*s)),r=new OffscreenCanvas(o,n),i=r.getContext("2d");if(!i){self.postMessage({error:"Failed to get 2D context"});return}i.drawImage(e,0,0,o,n);const f=await r.convertToBlob({type:"image/jpeg",quality:.85});self.postMessage({blob:f})}catch(t){self.postMessage({error:t instanceof Error?t.message:String(t)})}}})();
